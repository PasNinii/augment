"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5051],{5051:(S,v,c)=>{c.r(v),c.d(v,{DigestModule:()=>z});var t=c(177),l=c(4341),p=c(1075),e=c(4438);let F=(()=>{class n{static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275mod=e.$C({type:n});static#n=this.\u0275inj=e.G2t({imports:[l.X1,p.bv,t.MD]})}return n})();var T=c(3727),d=c(9664),D=c(3779),C=c(1626),y=c(4412),$=c(7673),E=c(4572),G=c(8141),R=c(5558),b=function(n){return n.EXPRESSION="expression",n.FACT="fact",n.QUOTE="quote",n.WORD="word",n}(b||{}),x=c(9265),I=c(9079);const M=()=>["text","number","url"];function N(n,h){if(1&n&&(e.j41(0,"ion-label"),e.EFF(1),e.k0s()),2&n){const o=e.XpG();e.R7$(),e.JRh(o.control.label)}}function W(n,h){if(1&n&&e.nrm(0,"ion-input",2),2&n){const o=e.XpG();e.Y8G("type",o.control.type)("formControlName",o.control.name)("value",o.control.value)}}function s(n,h){if(1&n&&e.nrm(0,"ion-textarea",3),2&n){const o=e.XpG();e.Y8G("formControlName",o.control.name)("value",o.control.value)}}function f(n,h){if(1&n&&e.nrm(0,"ion-checkbox",4),2&n){const o=e.XpG();e.Y8G("formControlName",o.control.name)("checked",o.control.value)}}function i(n,h){if(1&n&&e.nrm(0,"ion-toggle",4),2&n){const o=e.XpG();e.Y8G("formControlName",o.control.name)("checked",o.control.value)}}let a=(()=>{class n{static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275cmp=e.VBU({type:n,selectors:[["app-form"]],inputs:{form:"form",groupName:"groupName",control:"control"},decls:7,vars:5,consts:[[3,"formGroup"],[3,"formGroupName"],[3,"type","formControlName","value"],[3,"formControlName","value"],[3,"formControlName","checked"]],template:function(r,m){1&r&&(e.qex(0,0)(1,1),e.DNE(2,N,2,1,"ion-label")(3,W,1,3,"ion-input",2)(4,s,1,2)(5,f,1,2)(6,i,1,2),e.bVm()()),2&r&&(e.Y8G("formGroup",m.form),e.R7$(),e.Y8G("formGroupName",m.groupName),e.R7$(),e.vxM(2,m.control.label?2:-1),e.R7$(),e.vxM(3,e.lJ4(4,M).includes(m.control.type)?3:"textarea"===m.control.type?4:"checkbox"===m.control.type?5:"toggle"===m.control.type?6:-1))},dependencies:[l.BC,l.cb,l.j4,l.JD,l.$R,p.eY,p.$w,p.he,p.nc,p.BY,p.hB,p.Gw],encapsulation:2,changeDetection:0})}return n})();const u=(n,h)=>h.name;function g(n,h){if(1&n&&(e.j41(0,"ion-item",3),e.nrm(1,"app-form",4),e.k0s()),2&n){const o=h.$implicit,r=e.XpG().$implicit,m=e.XpG();e.R7$(),e.Y8G("control",o)("form",m.formGroup)("groupName",r)}}function V(n,h){if(1&n&&(e.qex(0,1),e.Z7z(1,g,2,3,"ion-item",3,u),e.bVm()),2&n){const o=h.$implicit,r=e.XpG();e.Y8G("formGroupName",o),e.R7$(),e.Dyx(r.formData[o])}}let Y=(()=>{class n{constructor(){this.fb=(0,e.WQX)(l.ok),this.formSubmit=new e.bkB,this.formDataKeys=[],this.formGroup=this.fb.group({})}ngOnChanges(o){this.formDataKeys=Object.keys(this.formData),this.formGroup=this.createForm(this.formData,this.editDto)}createForm(o,r){const m={};return Object.keys(o).forEach(_=>{const j={};o[_].forEach(X=>{const J=r?this.getDtoValue(X.name):X.value;j[X.name]=new l.MJ(J)}),m[_]=new l.gE(j)}),new l.gE(m)}getDtoValue(o){if(this.editDto?.dimensions)return this.editDto.dimensions.find(r=>r.name===o)?.content}onSubmit(){if(this.formGroup.valid){const o=this.editDto?.id??void 0;this.formSubmit.emit({id:o,value:{id:o,...this.formGroup.value}})}}static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275cmp=e.VBU({type:n,selectors:[["app-form-wrapper"]],inputs:{formData:"formData",editDto:"editDto"},outputs:{formSubmit:"formSubmit"},features:[e.OA$],decls:5,vars:1,consts:[[1,"form-wrapper-container",3,"ngSubmit","formGroup"],[3,"formGroupName"],["expand","full","type","submit",1,"form-item-container"],[1,"form-item-container"],[3,"control","form","groupName"]],template:function(r,m){1&r&&(e.j41(0,"form",0),e.bIt("ngSubmit",function(){return m.onSubmit()}),e.Z7z(1,V,3,1,"ng-container",1,e.fX1),e.j41(3,"ion-button",2),e.EFF(4,"Submit"),e.k0s()()),2&r&&(e.Y8G("formGroup",m.formGroup),e.R7$(),e.Dyx(m.formDataKeys))},dependencies:[l.qT,l.cb,l.j4,l.$R,p.Jm,p.uz,a],styles:[".form-wrapper-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.form-item-container[_ngcontent-%COMP%]{margin-top:2em}"],changeDetection:0})}return n})();function B(n,h){if(1&n&&(e.j41(0,"ion-select-option",8),e.EFF(1),e.nI1(2,"titlecase"),e.k0s()),2&n){const o=h.$implicit;e.Y8G("value",o),e.R7$(),e.JRh(e.bMT(2,2,o))}}function U(n,h){if(1&n){const o=e.RV6();e.j41(0,"app-form-wrapper",11),e.bIt("formSubmit",function(m){e.eBV(o);const _=e.XpG();return e.Njj(_.upsert(m))}),e.k0s()}if(2&n){const o=e.XpG();e.Y8G("editDto",null==o.editDto?null:o.editDto.digest)("formData",h)}}const O=[{path:"",component:D.z},{path:"edit",component:(()=>{class n{constructor(){this.router=(0,e.WQX)(d.Ix),this.httpClient=(0,e.WQX)(C.Qq),this.digestService=(0,e.WQX)(x.K),this.digestEntriesUrl="tabs/digest",this.loaded$=new y.t(!1),this.selectedType$=new y.t(b.QUOTE),this.types$=(0,$.of)(Object.values(b)),this.editDto=void 0,this.formData$=(0,E.z)([this.selectedType$]).pipe((0,G.M)(()=>this.loaded$.next(!1)),(0,R.n)(([o])=>this.httpClient.get(`/assets/template/form/digest/${o}-form.json`)),(0,G.M)(()=>{this.loaded$.next(!0)})),this.router.events.pipe((0,I.pQ)()).subscribe(o=>{if(o instanceof d.wF){const r=this.router.getCurrentNavigation()?.extras?.state;r?(this.editDto=r,this.selectedType$.next(r.selectedType)):(this.editDto=void 0,this.selectedType$.next(b.QUOTE))}})}onTypeChange(o){this.selectedType$.next(o.detail.value)}upsert(o){const r={digest:{type:this.selectedType$.getValue()},dimensions:{...o.value.dimensions}};r.digest.type=this.selectedType$.getValue(),this.digestService.customUpsert(r,o.id),this.navigateTo(this.digestEntriesUrl)}navigateTo(o){this.router.navigate([o])}getTitle(){return`${this.editDto?"Editer":"Ajouter"} ${this.selectedType$.getValue()}`}static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275cmp=e.VBU({type:n,selectors:[["ng-component"]],decls:25,vars:17,consts:[[3,"translucent"],[2,"{height","100%}",3,"fullscreen"],["collapse","condense"],["size","large"],["slot","end"],[3,"click"],[1,"digest-form-wrapper-container"],["interface","action-sheet","placeholder","Type",3,"ionChange","value"],[3,"value"],[3,"loaded"],[3,"editDto","formData"],[3,"formSubmit","editDto","formData"]],template:function(r,m){if(1&r&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e.EFF(3),e.k0s()()(),e.j41(4,"ion-content",1)(5,"ion-header",2)(6,"ion-toolbar")(7,"ion-title",3),e.EFF(8),e.nI1(9,"async"),e.k0s(),e.j41(10,"ion-buttons",4)(11,"ion-button",5),e.bIt("click",function(){return m.navigateTo(m.digestEntriesUrl)}),e.EFF(12,"Parcourir les entr\xe9es"),e.k0s()()()(),e.j41(13,"div",6)(14,"ion-list")(15,"ion-item")(16,"ion-select",7),e.nI1(17,"async"),e.bIt("ionChange",function(j){return m.onTypeChange(j)}),e.Z7z(18,B,3,4,"ion-select-option",8,e.fX1),e.nI1(20,"async"),e.k0s()()(),e.j41(21,"app-progress-bar",9),e.nI1(22,"async"),e.DNE(23,U,1,2,"app-form-wrapper",10),e.nI1(24,"async"),e.k0s()()()),2&r){let _;e.Y8G("translucent",!0),e.R7$(3),e.JRh(m.getTitle()),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(4),e.SpI("Add ",e.bMT(9,7,m.selectedType$),""),e.R7$(8),e.Y8G("value",e.bMT(17,9,m.selectedType$)),e.R7$(2),e.Dyx(e.bMT(20,11,m.types$)),e.R7$(3),e.Y8G("loaded",e.bMT(22,13,m.loaded$)),e.R7$(2),e.vxM(23,(_=e.bMT(24,15,m.formData$))?23:-1,_)}},dependencies:[p.Jm,p.QW,p.W9,p.eU,p.uz,p.nf,p.Nm,p.Ip,p.BC,p.ai,p.Je,Y,T.a,t.Jj,t.PV],styles:[".digest-form-wrapper-container[_ngcontent-%COMP%]{margin:2em auto auto;width:75%;height:100%;display:flex;flex-direction:column}"],changeDetection:0})}return n})()}];let Q=(()=>{class n{static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275mod=e.$C({type:n});static#n=this.\u0275inj=e.G2t({imports:[t.MD,d.iI.forChild(O),d.iI]})}return n})(),z=(()=>{class n{static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275mod=e.$C({type:n});static#n=this.\u0275inj=e.G2t({imports:[t.MD,l.X1,Q,p.bv,F,T.a]})}return n})()},3727:(S,v,c)=>{c.d(v,{a:()=>T});var t=c(1075),l=c(4438);const p=["*"];function e(d,D){1&d&&l.SdG(0)}function F(d,D){if(1&d&&l.nrm(0,"ion-progress-bar",0),2&d){const C=l.XpG();l.Y8G("type",C.type)}}let T=(()=>{class d{constructor(){this.type="indeterminate",this.color="primary",this.loaded=!0}static#t=this.\u0275fac=function(y){return new(y||d)};static#e=this.\u0275cmp=l.VBU({type:d,selectors:[["app-progress-bar"]],inputs:{type:"type",color:"color",loaded:"loaded"},standalone:!0,features:[l.aNF],ngContentSelectors:p,decls:2,vars:1,consts:[[3,"type"]],template:function(y,$){1&y&&(l.NAR(),l.DNE(0,e,1,0)(1,F,1,1)),2&y&&l.vxM(0,$.loaded?0:1)},dependencies:[t.bv,t.FH],encapsulation:2,changeDetection:0})}return d})()},3779:(S,v,c)=>{c.d(v,{z:()=>W});var t=c(4438),l=c(9664),p=c(9265),e=c(1075),F=c(467),T=c(1626),d=c(6446),D=c(177);const C=(s,f)=>f.id;function y(s,f){if(1&s&&(t.j41(0,"p"),t.EFF(1),t.nI1(2,"titlecase"),t.k0s()),2&s){const i=f.$implicit;t.R7$(),t.Lme("",t.bMT(2,2,i.name),": ",i.content,"")}}function $(s,f){1&s&&t.nrm(0,"ion-icon",3)}function E(s,f){1&s&&t.nrm(0,"ion-icon",4)}function G(s,f){if(1&s&&(t.j41(0,"p"),t.EFF(1),t.nI1(2,"date"),t.DNE(3,$,1,0,"ion-icon",3)(4,E,1,0),t.k0s()),2&s){const i=f.$implicit;t.R7$(),t.SpI(" ",t.i5U(2,2,i.vtime,"dd/MM/yyyy")," "),t.R7$(2),t.vxM(3,i.isValidated?3:4)}}function R(s,f){if(1&s&&(t.j41(0,"h1"),t.EFF(1,"Content"),t.k0s(),t.Z7z(2,y,3,4,"p",null,C),t.j41(4,"h1"),t.EFF(5,"History"),t.k0s(),t.j41(6,"div",2),t.Z7z(7,G,5,5,"p",null,C),t.k0s()),2&s){const i=t.XpG();t.R7$(2),t.Dyx(i.digest.dimensions),t.R7$(5),t.Dyx(i.history)}}let b=(()=>{class s{constructor(){this.modalController=(0,t.WQX)(e.W3),this.http=(0,t.WQX)(T.Qq),this.history=void 0,this.digest=void 0}set entity(i){this.digest=i,this.http.get(`${d.c.ENVIRONMENT_VARIABLES.audience}/api/digest/history/${i.id}`).subscribe(a=>this.history=a)}confirm(){this.modalController.dismiss()}static#t=this.\u0275fac=function(a){return new(a||s)};static#e=this.\u0275cmp=t.VBU({type:s,selectors:[["app-digest-detail"]],decls:4,vars:1,consts:[[1,"augment-modal-wrapper"],[3,"click"],[1,"augment-modal-digest-history"],["name","checkmark-outline"],["name","close-outline"]],template:function(a,u){1&a&&(t.j41(0,"div",0),t.DNE(1,R,9,0),t.j41(2,"ion-button",1),t.bIt("click",function(){return u.confirm()}),t.EFF(3,"Fermer"),t.k0s()()),2&a&&(t.R7$(),t.vxM(1,u.digest?1:-1))},dependencies:[e.Jm,e.iq,D.PV,D.vh],styles:[".augment-modal-digest-history[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;max-height:200px;overflow:auto}"]})}return s})(),k=(()=>{class s{constructor(){this.modalController=(0,t.WQX)(e.W3)}confirm(i=!1){return this.modalController.dismiss(null,i?"confirm":"cancel")}static#t=this.\u0275fac=function(a){return new(a||s)};static#e=this.\u0275cmp=t.VBU({type:s,selectors:[["ng-component"]],standalone:!0,features:[t.aNF],decls:7,vars:2,consts:[[1,"augment-modal-wrapper"],[3,"click","color"]],template:function(a,u){1&a&&(t.j41(0,"div",0)(1,"p"),t.EFF(2,"Etes vous certains de votre choix ?"),t.k0s(),t.j41(3,"ion-button",1),t.bIt("click",function(){return u.confirm(!1)}),t.EFF(4,"No"),t.k0s(),t.j41(5,"ion-button",1),t.bIt("click",function(){return u.confirm(!0)}),t.EFF(6,"Yes"),t.k0s()()),2&a&&(t.R7$(3),t.Y8G("color","medium"),t.R7$(2),t.Y8G("color","danger"))},dependencies:[e.bv,e.Jm],encapsulation:2})}return s})();var x=c(3727);const I=(s,f)=>f.id;function M(s,f){if(1&s){const i=t.RV6();t.j41(0,"ion-list")(1,"ion-item")(2,"ion-grid")(3,"ion-row")(4,"ion-col",1),t.EFF(5),t.nI1(6,"date"),t.k0s(),t.j41(7,"ion-col",1),t.EFF(8),t.nI1(9,"titlecase"),t.k0s(),t.j41(10,"ion-col",1),t.EFF(11),t.k0s(),t.j41(12,"ion-col",2)(13,"ion-button",3),t.bIt("click",function(){const u=t.eBV(i).$implicit,g=t.XpG();return t.Njj(g.openDigestDetail(u))}),t.EFF(14,"Detail"),t.k0s(),t.j41(15,"ion-button",3),t.bIt("click",function(){const u=t.eBV(i).$implicit,g=t.XpG();return t.Njj(g.editDigest(u))}),t.EFF(16,"Edit"),t.k0s(),t.j41(17,"ion-button",3),t.bIt("click",function(){const u=t.eBV(i).$implicit,g=t.XpG();return t.Njj(g.deleteDigest(u))}),t.EFF(18,"Delete"),t.k0s()()()()()()}if(2&s){const i=f.$implicit;t.R7$(5),t.JRh(t.i5U(6,6,i.ctime,"dd/MM/yyyy")),t.R7$(3),t.JRh(t.bMT(9,9,i.type)),t.R7$(3),t.JRh(i.dimensions[0].content),t.R7$(2),t.Y8G("color","success"),t.R7$(2),t.Y8G("color","tertiary"),t.R7$(2),t.Y8G("color","danger")}}let N=(()=>{class s{constructor(){this.modalController=(0,t.WQX)(e.W3),this.router=(0,t.WQX)(l.Ix),this.digestService=(0,t.WQX)(p.K),this.digestService.load()}openDigestDetail(i){var a=this;return(0,F.A)(function*(){(yield a.modalController.create({component:b,cssClass:"augment-modal",componentProps:{entity:i}})).present()})()}editDigest(i){this.router.navigate(["tabs/digest/edit"],{state:{digest:i,selectedType:i.type}})}deleteDigest(i){var a=this;return(0,F.A)(function*(){const u=yield a.modalController.create({component:k,cssClass:"augment-modal"});u.present();const{role:g}=yield u.onWillDismiss();"confirm"===g&&a.digestService.delete(i)})()}static#t=this.\u0275fac=function(a){return new(a||s)};static#e=this.\u0275cmp=t.VBU({type:s,selectors:[["app-digest-list"]],decls:6,vars:7,consts:[[3,"loaded"],["size","12","size-sm","5"],["size","12","size-sm","2","align-self-end",""],[3,"click","color"]],template:function(a,u){1&a&&(t.j41(0,"app-progress-bar",0),t.nI1(1,"async"),t.nI1(2,"async"),t.Z7z(3,M,19,11,"ion-list",null,I),t.nI1(5,"async"),t.k0s()),2&a&&(t.Y8G("loaded",t.bMT(1,1,u.digestService.loaded$)&&!t.bMT(2,3,u.digestService.loading$)),t.R7$(3),t.Dyx(t.bMT(5,5,u.digestService.entities$)))},dependencies:[e.Jm,e.hU,e.lO,e.uz,e.nf,e.ln,x.a,D.Jj,D.PV,D.vh],encapsulation:2,changeDetection:0})}return s})(),W=(()=>{class s{constructor(){this.router=(0,t.WQX)(l.Ix),this.digestService=(0,t.WQX)(p.K),this.digestEditUrl="tabs/digest/edit",this.digestService.load()}navigateTo(i){this.router.navigate([i])}static#t=this.\u0275fac=function(a){return new(a||s)};static#e=this.\u0275cmp=t.VBU({type:s,selectors:[["ng-component"]],decls:16,vars:2,consts:[[3,"translucent"],["slot","end",3,"click"],["color","success"],["name","add-circle"],[3,"fullscreen"],["collapse","condense"],["size","large"]],template:function(a,u){1&a&&(t.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),t.EFF(3,"Digests"),t.k0s(),t.j41(4,"ion-buttons",1),t.bIt("click",function(){return u.navigateTo(u.digestEditUrl)}),t.j41(5,"ion-button",2),t.nrm(6,"ion-icon",3),t.k0s()()()(),t.j41(7,"ion-content",4)(8,"ion-header",5)(9,"ion-toolbar")(10,"ion-title",6),t.EFF(11,"Digests"),t.k0s(),t.j41(12,"ion-buttons",1),t.bIt("click",function(){return u.navigateTo(u.digestEditUrl)}),t.j41(13,"ion-button",2),t.nrm(14,"ion-icon",3),t.k0s()()()(),t.nrm(15,"app-digest-list"),t.k0s()),2&a&&(t.Y8G("translucent",!0),t.R7$(7),t.Y8G("fullscreen",!0))},dependencies:[e.Jm,e.QW,e.W9,e.eU,e.iq,e.BC,e.ai,N],encapsulation:2,changeDetection:0})}return s})()}}]);